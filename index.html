import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Textarea } from "@/components/ui/textarea";

export default function ArgumentAnalyzer() {
  const [argument, setArgument] = useState("");
  const [analysis, setAnalysis] = useState(null);

  const analyzeArgument = () => {
    const standardForm = extractStandardForm(argument);
    const validity = checkValidity(standardForm);
    const strength = evaluateStrength(standardForm);
    const assumptions = identifyAssumptions(standardForm);
    const fallacies = detectFallacies(standardForm);

    setAnalysis({ standardForm, validity, strength, assumptions, fallacies });
  };

  return (
    <div className="max-w-xl mx-auto p-6">
      <h1 className="text-2xl font-bold mb-4">AI Argument Analyzer</h1>
      <Textarea
        placeholder="Enter an argument..."
        value={argument}
        onChange={(e) => setArgument(e.target.value)}
        className="w-full mb-4"
      />
      <Button onClick={analyzeArgument}>Analyze</Button>
      {analysis && (
        <Card className="mt-6">
          <CardContent>
            <h2 className="text-xl font-semibold">Standard Form:</h2>
            <p>{analysis.standardForm}</p>
            <h2 className="text-xl font-semibold mt-4">Validity:</h2>
            <p>{analysis.validity}</p>
            <h2 className="text-xl font-semibold mt-4">Strength (Inductive Arguments):</h2>
            <p>{analysis.strength}</p>
            <h2 className="text-xl font-semibold mt-4">Possible Assumptions:</h2>
            <ul>
              {analysis.assumptions.map((assumption, index) => (
                <li key={index}>- {assumption}</li>
              ))}
            </ul>
            <h2 className="text-xl font-semibold mt-4">Potential Fallacies Detected:</h2>
            <ul>
              {analysis.fallacies.map((fallacy, index) => (
                <li key={index}>! {fallacy}</li>
              ))}
            </ul>
          </CardContent>
        </Card>
      )}
    </div>
  );
}

function extractStandardForm(argument) {
  return "P1: If X, then Y\nP2: X\nConclusion: Y";
}

function checkValidity(standardForm) {
  if (standardForm.includes("If") && standardForm.includes("then")) {
    return "✓ This argument appears valid.";
  }
  return "X This argument is invalid. The conclusion does not logically follow from the premises.";
}

function evaluateStrength(standardForm) {
  if (standardForm.includes("most likely") || standardForm.includes("probably")) {
    return "✓ This argument is strong.";
  }
  return "X This argument is weak.";
}

function identifyAssumptions(standardForm) {
  return [
    "The argument might require an additional premise to logically support the conclusion.",
  ];
}

function detectFallacies(standardForm) {
  const fallacies = [];
  if (standardForm.includes("everyone knows")) {
    fallacies.push("Appeal to Popularity");
  }
  if (standardForm.includes("never") || standardForm.includes("always")) {
    fallacies.push("Hasty Generalization");
  }
  if (standardForm.includes("since X happened before Y, Y must be caused by X")) {
    fallacies.push("False Cause");
  }
  if (standardForm.includes("attacks the character instead of the argument")) {
    fallacies.push("Ad Hominem");
  }
  if (standardForm.includes("presents only two choices when more exist")) {
    fallacies.push("False Dilemma");
  }
  if (standardForm.includes("assumes extreme outcomes from minor changes")) {
    fallacies.push("Slippery Slope");
  }
  if (standardForm.includes("the conclusion repeats the premise")) {
    fallacies.push("Circular Reasoning");
  }
  if (standardForm.includes("misrepresenting the opponent’s argument")) {
    fallacies.push("Straw Man Fallacy");
  }
  return fallacies;
}
